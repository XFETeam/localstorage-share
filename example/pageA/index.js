!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.localstorageShare=t():e.localstorageShare=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATA_CLONE_ERROR=t.MESSAGE=t.REJECTED=t.FULFILLED=t.REPLY=t.CALL=t.HANDSHAKE_REPLY=t.HANDSHAKE=void 0;t.HANDSHAKE="handshake";t.HANDSHAKE_REPLY="handshake-reply";t.CALL="call";t.REPLY="reply";t.FULFILLED="fulfilled";t.REJECTED="rejected";t.MESSAGE="message";t.DATA_CLONE_ERROR="DataCloneError"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERR_NO_IFRAME_SRC=t.ERR_NOT_IN_IFRAME=t.ERR_CONNECTION_TIMEOUT=t.ERR_CONNECTION_DESTROYED=void 0;t.ERR_CONNECTION_DESTROYED="ConnectionDestroyed";t.ERR_CONNECTION_TIMEOUT="ConnectionTimeout";t.ERR_NOT_IN_IFRAME="NotInIframe";t.ERR_NO_IFRAME_SRC="NoIframeSrc"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeError=t.serializeError=void 0;t.serializeError=e=>{return{name:e.name,message:e.message,stack:e.stack}};t.deserializeError=e=>{const t=new Error;return Object.keys(e).forEach(r=>t[r]=e[r]),t}},function(e,t,r){const n=r(4);e.exports=new class{constructor(){this.serve="http://10.11.165.86:61140/"}init(){const e=document.createElement("iframe");e.src=this.serve,e.style.display="none",document.body.appendChild(e),this.connection=n({iframe:e})}getItem(e,t){return this.getCallback=t,this.connection||this.init(),this.connection.promise.then(t=>t.get(e))}setItem(e,t){return this.connection||this.init(),this.connection.promise.then(r=>r.set(e,t))}removeItem(e){return this.connection||this.init(),this.connection.promise.then(t=>t.set(e,""))}clear(){return this.connection||this.init(),this.connection.promise.then(e=>e.clear())}getItems(){return this.connection||this.init(),this.connection.promise.then(e=>e.getAll())}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),o=r(1),i=l(r(5)),s=l(r(6)),a=l(r(7)),c=l(r(8)),d=l(r(9));function l(e){return e&&e.__esModule?e:{default:e}}t.default=e=>{let t=e.iframe,r=e.methods,l=void 0===r?{}:r,u=e.childOrigin,f=e.timeout,E=e.debug;const p=(0,a.default)(E),m=window,h=(0,i.default)(),_=h.destroy,v=h.onDestroy;if(!u){if(!t.src&&!t.srcdoc){const e=new Error("Iframe must have src or srcdoc property defined.");throw e.code=o.ERR_NO_IFRAME_SRC,e}u=(0,s.default)(t.src)}const R="null"===u?"*":u;return{promise:new Promise((e,r)=>{let i;void 0!==f&&(i=setTimeout(()=>{const e=new Error(`Connection to child timed out after ${f}ms`);e.code=o.ERR_CONNECTION_TIMEOUT,r(e),_()},f));const s={};let a,E;const h=r=>{const o=t.contentWindow;if(r.source!==o||r.data.penpal!==n.HANDSHAKE)return;if(r.origin!==u)return void p(`Parent received handshake from origin ${r.origin} which did not match expected origin ${u}`);p("Parent: Received handshake, sending reply"),r.source.postMessage({penpal:n.HANDSHAKE_REPLY,methodNames:Object.keys(l)},R);const f={localName:"Parent",local:m,remote:o,originForSending:R,originForReceiving:u};E&&E(),E=(0,c.default)(f,l,p),v(E),a&&a.forEach(e=>{delete s[e]}),a=r.data.methodNames;const h=(0,d.default)(s,f,a,_,p);v(h),clearTimeout(i),e(s)};m.addEventListener(n.MESSAGE,h),p("Parent: Awaiting handshake");var g=setInterval(()=>{document.contains(t)||(clearInterval(g),_())},6e4);v(()=>{m.removeEventListener(n.MESSAGE,h),clearInterval(g);const e=new Error("Connection destroyed");e.code=o.ERR_CONNECTION_DESTROYED,r(e)})}),destroy:_}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=()=>{const e=[];let t=!1;return{destroy(){t=!0,e.forEach(e=>{e()})},onDestroy(r){t?r():e.push(r)}}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n={"http:":"80","https:":"443"},o=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,i=["file:","data:"];t.default=e=>{if(e&&i.find(t=>e.startsWith(t)))return"null";const t=document.location,r=o.exec(e);let s,a,c;return r?(s=r[1]?r[1]:t.protocol,a=r[2],c=r[4]):(s=t.protocol,a=t.hostname,c=t.port),`${s}//${a}${c&&c!==n[s]?`:${c}`:""}`},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=e=>(function(){if(e){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];console.log("[Penpal]",...r)}}),e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),o=r(2);t.default=(e,t,r)=>{const i=e.localName,s=e.local,a=e.remote,c=e.originForSending,d=e.originForReceiving;let l=!1;r(`${i}: Connecting call receiver`);const u=e=>{if(e.source!==a||e.data.penpal!==n.CALL)return;if(e.origin!==d)return void r(`${i} received message from origin ${e.origin} which did not match expected origin ${d}`);const s=e.data,u=s.methodName,f=s.args,E=s.id;r(`${i}: Received ${u}() call`);const p=e=>t=>{if(r(`${i}: Sending ${u}() reply`),l)return void r(`${i}: Unable to send ${u}() reply due to destroyed connection`);const s={penpal:n.REPLY,id:E,resolution:e,returnValue:t};e===n.REJECTED&&t instanceof Error&&(s.returnValue=(0,o.serializeError)(t),s.returnValueIsError=!0);try{a.postMessage(s,c)}catch(e){throw e.name===n.DATA_CLONE_ERROR&&a.postMessage({penpal:n.REPLY,id:E,resolution:n.REJECTED,returnValue:(0,o.serializeError)(e),returnValueIsError:!0},c),e}};new Promise(e=>e(t[u].apply(t,f))).then(p(n.FULFILLED),p(n.REJECTED))};return s.addEventListener(n.MESSAGE,u),()=>{l=!0,s.removeEventListener(n.MESSAGE,u)}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=r(0),i=r(1),s=(n=r(10))&&n.__esModule?n:{default:n},a=r(2);t.default=(e,t,r,n,c)=>{const d=t.localName,l=t.local,u=t.remote,f=t.originForSending,E=t.originForReceiving;let p=!1;c(`${d}: Connecting call sender`);return r.reduce((e,t)=>(e[t]=(e=>(function(){for(var t=arguments.length,r=new Array(t),m=0;m<t;m++)r[m]=arguments[m];let h;c(`${d}: Sending ${e}() call`);try{u.closed&&(h=!0)}catch(e){h=!0}if(h&&n(),p){const t=new Error(`Unable to send ${e}() call due `+"to destroyed connection");throw t.code=i.ERR_CONNECTION_DESTROYED,t}return new Promise((t,n)=>{const i=(0,s.default)(),p=r=>{if(r.source!==u||r.data.penpal!==o.REPLY||r.data.id!==i)return;if(r.origin!==E)return void c(`${d} received message from origin ${r.origin} which did not match expected origin ${E}`);c(`${d}: Received ${e}() reply`),l.removeEventListener(o.MESSAGE,p);let s=r.data.returnValue;r.data.returnValueIsError&&(s=(0,a.deserializeError)(s)),(r.data.resolution===o.FULFILLED?t:n)(s)};l.addEventListener(o.MESSAGE,p),u.postMessage({penpal:o.CALL,id:i,methodName:e,args:r},f)})}))(t),e),e),()=>{p=!0}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;let n=0;t.default=()=>++n,e.exports=t.default}])}));